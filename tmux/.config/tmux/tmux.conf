# reload config file (change file location to your the tmux.conf you want to use)
# unbind r
# bind r source-file "$XDG_CONFIG_HOME/tmux/tmux.conf"

source-file "$XDG_CONFIG_HOME/tmux/reset.conf"
source-file "$XDG_CONFIG_HOME/tmux/style.conf"

# remap prefix from 'C-b' to 'C-a'
# unbind C-b
# set -g prefix C-a
# bind C-a send-prefix

# split panes using | and -
bind-key | split-window -h -c "#{pane_current_path}"
bind-key - split-window -v -c "#{pane_current_path}"
unbind-key '"'
unbind-key %

# new window in current pane's path
bind-key c new-window -c "#{pane_current_path}"

# vi style panes navigation
# bind-key h select-pane -L
# bind-key j select-pane -D
# bind-key k select-pane -U
# bind-key l select-pane -R

# switch panes using Shift-arrow without prefix
bind-key -n S-Left  select-pane -L
bind-key -n S-Right select-pane -R
bind-key -n S-Up    select-pane -U
bind-key -n S-Down  select-pane -D

PROMPT_SYMBOL="\u276f" # ❯

# opt+up/opt+down to navigate to the previous or next prompt command in copy mode
bind-key -T copy-mode M-Up   send-keys -X search-backward $PROMPT_SYMBOL
bind-key -T copy-mode M-Down send-keys -X search-forward  $PROMPT_SYMBOL

bind-key -T root M-Up        copy-mode \; send-keys -X search-backward $PROMPT_SYMBOL
bind-key -T root M-Down      copy-mode \; send-keys -X search-forward $PROMPT_SYMBOL

# scroll up/down one line at a time
bind-key -T copy-mode WheelUpPane   select-pane \; send-keys -X -N 1 scroll-up
bind-key -T copy-mode WheelDownPane select-pane \; send-keys -X -N 1 scroll-down

# double-click to copy a word, triple-click to copy a line; but staying in copy mode
bind-key -T copy-mode DoubleClick1Pane select-pane \; send-keys -X select-word \; run-shell -d 0.3 \; send-keys -X copy-pipe #\; display-message "Copied: #{=/70/…:buffer_sample}"
bind-key -T copy-mode TripleClick1Pane select-pane \; send-keys -X select-line \; run-shell -d 0.3 \; send-keys -X copy-pipe #\; display-message "Copied: #{=/70/…:buffer_sample}"

# move the cursor to the position you clicked
bind-key -T copy-mode MouseDown1Pane select-pane \; send-keys -X mouse-event

# select, copy and stay in copy mode
bind-key -T copy-mode MouseDragEnd1Pane send-keys -X copy-pipe #\; display-message "Copied: #{=/70/…:buffer_sample}"

# enter copy the selection and exit copy mode (or y to copy without exiting)
bind-key -T copy-mode Enter send-keys -X copy-pipe-and-cancel #\; display-message "Copied: #{=/70/…:buffer_sample}"
bind-key -T copy-mode y     send-keys -X copy-pipe #\; display-message "Copied: #{=/70/…:buffer_sample}"

# w copy the word at the cursor
bind-key -T copy-mode w send-keys -X select-word \; run-shell -d 0.3 \; send-keys -X copy-pipe #\; display-message "Copied: #{=/70/…:buffer_sample}"

# ctrl+l clear the screen and the history
bind-key -n C-l send-keys C-l \; run-shell -d 0.3 \; clear-history

# set emacs mode
set -g mode-key emacs

# enable mouse control (clickable windows, panes, resizable panes)
set -g mouse on

# start numbering windows and panes from 1 instead of 0
set -g base-index 1
set -g pane-base-index 1

# renumber windows when a window is closed
set -g renumber-windows on

# display pane numbers for 4 seconds
set -g display-panes-time 4000

# enable rgb colors
set -sg terminal-overrides ',*:RGB'

# change terminal window title
set -g set-titles on
set -g set-titles-string '#S:#I:#W #{session_alerts}'

# the status bar doesn't need to refresh so frequently
# set -g status-interval 30

# word selection: remove '.' so double-click selects whole numbers
set -g word-separators '=/[]()"#:'

set-environment -g TMUX_PLUGIN_MANAGER_PATH "$XDG_DATA_HOME/tmux/plugins"

# list of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'

if "test ! -d $XDG_DATA_HOME/tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm $XDG_DATA_HOME/tmux/plugins/tpm && $XDG_DATA_HOME/tmux/plugins/tpm/bin/install_plugins'"

# initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
# git clone https://github.com/tmux-plugins/tpm $XDG_DATA_HOME/tmux/plugins/tpm
run "$XDG_DATA_HOME/tmux/plugins/tpm/tpm"
